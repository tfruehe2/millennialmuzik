{% load staticfiles %}

{% for post in post_list %}
  {% include "snippets/post_cells.html" %}
{% endfor %}

{% if is_paginated %}
<ul class="pagination">
  {% if page_obj.has_previous %}
    <li><a href="{{ newurl }}?page={{ page_obj.previous_page_number }}">&laquo;</a></li>
  {% else %}
    <li class="disabled"><span>&laquo;</span></li>
  {% endif %}
  {% for i in paginator.page_range %}
    {% if page_obj.number == i %}
      <li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
    {% else %}
      <li><a href="{{ newurl }}?page={{ i }}">{{ i }}</a></li>
    {% endif %}
  {% endfor %}
  {% if page_obj.has_next %}
    <li><a href="{{ newurl }}?page={{ page_obj.next_page_number }}">&raquo;</a></li>
  {% else %}
    <li class="disabled"><span>&raquo;</span></li>
  {% endif %}
</ul>
{% endif %}

<script src="{% static 'blog/music_cell_buttons.js' %}"></script>
<script>

$("button.twitter-button").hover(function(e){
  e.preventDefault();
  $(this)
      .find('img')
      .prop("src", "{% static "blog/icons/Twitter_Logo_Blue.png" %}");
},
function(e){
  e.preventDefault();
  $(this)
      .find('img')
      .prop("src", "{% static "blog/icons/Twitter_Logo_grey.png" %}");
});

$("button.fb-button").click(function(){
  $this = $(this);
  FB.ui({
    method: 'share',
    display: 'popup',
    href: $this.attr('data-url'),
  }, function(response){});
});


$( "button.like-button" ).click(function(e) {
  e.preventDefault();
  var $this = $(this);
  console.log("button clicked")
  $.ajax({
    url: "{% url "blog:add_like" %}",
    type: 'POST',
    data: {'post_id': $this.attr('data-id')},
    success: function(json) {
      $this
        .removeClass("like-button")
        .addClass("liked-button")
        .find('i')
        .removeClass("fa-heart-o")
        .addClass("fa-heart");
    },
    error: function(error) {
      console.log("failed to like post");
    },
  });
});

$("button.liked-button").click(function(e) {
  e.preventDefault();
  var $this = $(this);
  $.ajax({
    url: "{% url "blog:add_like" %}",
    type: 'POST',
    data: {'post_id': $this.attr('data-id')},
    success: function(json) {
      $this
      .removeClass("liked-button")
      .addClass("like-button")
      .find('i')
      .removeClass("fa-heart")
      .addClass("fa-heart-o");
    },
    error: function(error) {
      console.log("failed to unlike post");
    },
  });
});

$('.lyrics-button').click(function(e){
  e.preventDefault();
  var $this = $(this)
    $this
      .closest('div.col-sm-2')
      .prevAll('.panel-body')
      .hide()
      .next('.text-scroller')
      .removeClass('hidden');
    $this.remove()
});

</script>
